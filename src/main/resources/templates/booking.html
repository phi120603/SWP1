<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Đặt kho</title>
  <link rel="stylesheet" href="/css/booking-styles.css">
</head>
<body>

<!-- Navigation Bar -->
<nav class="navbar">
  <div class="nav-container">
    <div class="logo">QVL Storage</div>
    <ul class="nav-links">
      <li><a th:href="@{/}">Home</a></li>
      <li><a th:href="@{/SWP/booking/search}">Đặt kho</a></li>
      <li><a th:href="@{/SWP/storages}">Danh sách</a></li>
      <li><a th:href="@{/SWP/customers/my-bookings}">Đơn hàng của tôi</a></li>
    </ul>
  </div>
</nav>

<div class="main-content">
  <div class="container">
    <div class="page-header">
      <h1 class="page-title">Xác nhận đặt kho</h1>
    </div>

    <div class="booking-card">
      <div class="card-content">

        <div th:if="${error}" class="message error" th:text="${error}"></div>

        <div th:if="${storage == null}">
          <div class="message error">Không tìm thấy kho.</div>
          <a th:href="@{/SWP/storages}" class="btn btn-secondary">Quay lại danh sách</a>
        </div>

        <div th:if="${storage != null}">
          <!-- Thông tin kho -->
          <div class="info-section">
            <div class="info-item">
              <label>Kho:</label>
              <span th:text="${storage.storagename}">Tên kho</span>
            </div>
            <div class="info-item">
              <label>Giá mỗi ngày:</label>
              <span th:text="${storage.pricePerDay} + ' VNĐ'">0 VNĐ</span>
            </div>
            <div class="info-item">
              <label>Ngày thuê:</label>
              <span th:text="${startDate}">Từ</span> - <span th:text="${endDate}">Đến</span>
            </div>
          </div>

          <!-- Form đặt kho -->
          <form th:action="@{'/SWP/booking/' + ${storage.storageid} + '/booking/save'}" method="post" class="booking-form">

            <!-- Hidden -->
            <input type="hidden" name="startDate" th:value="${startDate}" />
            <input type="hidden" name="endDate" th:value="${endDate}" />

            <!-- Nếu khách chưa đăng nhập, hiển thị input -->
            <div th:if="${customer == null}">
              <div class="form-group">
                <label>Họ tên:</label>
                <input type="text" name="name" required />
              </div>
              <div class="form-group">
                <label>Email:</label>
                <input type="email" name="email" required />
              </div>
              <div class="form-group">
                <label>SĐT:</label>
                <input type="text" name="phone" required />
              </div>
            </div>

            <!-- Nếu đã đăng nhập, truyền ẩn -->
            <div th:if="${customer != null}">
              <input type="hidden" name="name" th:value="${customer.fullname}" />
              <input type="hidden" name="email" th:value="${customer.email}" />
              <input type="hidden" name="phone" th:value="${customer.phone}" />
            </div>

            <div class="total-amount">
              Tổng tiền (ước tính):
              <span th:text="${#temporals.daysBetween(startDate, endDate)} * ${storage.pricePerDay} + ' VNĐ'">0 VNĐ</span>
            </div>

            <!-- Submit -->
            <div class="action-section">
              <button type="submit" class="btn btn-primary">Xác nhận đặt kho</button>
              <a th:href="@{/SWP/storages/{id}(id=${storage.storageid})}" class="btn btn-secondary">Quay lại</a>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
